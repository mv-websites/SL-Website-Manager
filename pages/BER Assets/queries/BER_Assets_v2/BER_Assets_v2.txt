SELECT 
    le.Equip_Status_Description AS serviceable, 
    le.Customer,
    le.Client_Group,
    le.Asset_Number AS asset_number, 
    le.serial_number, 
    CONCAT(le.Make, ' - ', le.Model) AS make_model, 
    le.description, 
    le.Location AS location, 
    CONCAT('[', le.Post_Code, ']', ' - ', le.Co_Name) AS site, 
    le.Post_Code AS postcode,
    le.`EQ_CODE_(DB)` AS eq_code,
    -- has_replacement_options: 1 if eq_code exists in asset_replacement_status, else 0
    CASE WHEN ars.eq_code THEN 1 ELSE 0 END AS has_replacement_options,
    COALESCE(ars.has_customer_viewed, 0) AS has_customer_viewed
FROM tempdev_.LiveEquipment_SL le
LEFT JOIN asset_replacement_status ars
    ON ars.eq_code = le.`EQ_CODE_(DB)`
WHERE le.Equip_Status_Description = "BER";
